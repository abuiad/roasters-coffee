<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ø¯Ù„ÙŠÙ„ Ù…Ø­Ø§Ù…Øµ Ø§Ù„Ù‚Ù‡ÙˆØ© Ø§Ù„Ù…Ø®ØªØµØ©</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 font-sans">

  <!-- Ø§Ù„Ù‡ÙŠØ¯Ø± Ù…Ø¹ ØµÙˆØ±Ø© Ø®Ù„ÙÙŠØ© -->
  <header class="relative shadow mb-6 text-center text-white">
    <div class="absolute inset-0 bg-black/50"></div> <!-- Ø·Ø¨Ù‚Ø© Ø´ÙØ§ÙØ© -->
    <img src="https://images.unsplash.com/photo-1509042239860-f550ce710b93" 
         alt="coffee" class="w-full h-52 object-cover">
    <div class="absolute inset-0 flex flex-col items-center justify-center">
      <h1 class="text-3xl font-bold drop-shadow-lg">â˜• Ù…Ø­Ø§Ù…Øµ Ø§Ù„Ù‚Ù‡ÙˆØ© Ø§Ù„Ù…Ø®ØªØµØ©</h1>
      <p class="text-gray-200">Ø§Ø³ØªÙƒØ´Ù - Ù‚ÙŠÙ‘Ù… - Ø£Ø¶Ù Ù…Ø­Ù…ØµØªÙƒ Ø§Ù„Ù…ÙØ¶Ù„Ø©</p>
    </div>
  </header>

  <!-- Ø§Ù„Ø£Ø¯ÙˆØ§Øª -->
  <section class="max-w-6xl mx-auto px-4 mb-6 flex flex-col md:flex-row items-center justify-between gap-3">
    <input id="search" type="text" placeholder="ğŸ” Ø§Ø¨Ø­Ø« Ø¨Ø§Ù„Ø§Ø³Ù… Ø£Ùˆ Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©" 
           class="border p-2 rounded-lg w-full md:w-1/3">

    <select id="sort" class="border p-2 rounded-lg">
      <option value="">Ø¨Ø¯ÙˆÙ† ØªØ±ØªÙŠØ¨</option>
      <option value="name">Ø§Ù„Ø§Ø³Ù… (Ø£Ø¨Ø¬Ø¯ÙŠ)</option>
      <option value="city">Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©</option>
    </select>

    <select id="filterRating" class="border p-2 rounded-lg">
      <option value="0">ÙƒÙ„ Ø§Ù„ØªÙ‚ÙŠÙŠÙ…Ø§Øª</option>
      <option value="4">4 â­ ÙÙ…Ø§ ÙÙˆÙ‚</option>
      <option value="5">5 â­ ÙÙ‚Ø·</option>
    </select>

    <button id="filterFav" class="bg-red-200 px-3 py-1 rounded">Ø§Ù„Ù…ÙØ¶Ù„Ø© â¤ï¸</button>
  </section>

  <!-- Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª -->
  <main id="roastersList" class="grid gap-6 grid-cols-1 md:grid-cols-2 lg:grid-cols-3 max-w-6xl mx-auto px-4">
    <!-- ÙŠØªÙ… Ø­Ù‚Ù† Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª Ù‡Ù†Ø§ -->
  </main>

  <!-- Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„Ø¥Ø¶Ø§ÙØ© -->
  <footer class="bg-white mt-10 shadow-inner p-6">
    <h2 class="text-xl font-semibold mb-4 text-gray-700">â• Ø¥Ø¶Ø§ÙØ© Ù…Ø­Ù…ØµØ© Ø¬Ø¯ÙŠØ¯Ø©</h2>
    <form id="roasterForm" class="grid gap-3 md:grid-cols-2">
      <input type="text" id="name" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ø­Ù…ØµØ©" class="border p-2 rounded" required>
      <input type="text" id="city" placeholder="Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©" class="border p-2 rounded" required>
      <input type="url" id="website" placeholder="Ø±Ø§Ø¨Ø· Ø§Ù„Ù…ÙˆÙ‚Ø¹" class="border p-2 rounded" required>
      <input type="file" id="logo" accept="image/*" class="border p-2 rounded">
      <button type="submit" class="bg-green-500 text-white py-2 px-4 rounded hover:bg-green-600 md:col-span-2">
        Ø¥Ø¶Ø§ÙØ©
      </button>
    </form>
  </footer>

<script>
let roasters = JSON.parse(localStorage.getItem("roasters")) || [
  {id:1,name:"Ù…Ø­Ù…Ø§Øµ Ø§Ù„Ø±ÙŠØ§Ø¶",city:"Ø§Ù„Ø±ÙŠØ§Ø¶",website:"https://example.com",logo:"",rating:4,favorite:false},
  {id:2,name:"Ø¨Ù† Ø¬Ø¯Ø©",city:"Ø¬Ø¯Ø©",website:"https://example.com",logo:"",rating:5,favorite:true}
];
let showFavoritesOnly = false;

function saveData(){ localStorage.setItem("roasters", JSON.stringify(roasters)); }

function renderCard(r){
  const card=document.createElement("div");
  card.className="bg-white shadow rounded-lg p-4 flex flex-col items-center text-center";

  card.innerHTML=`
    <img src="${r.logo||'https://via.placeholder.com/100'}" class="w-24 h-24 object-cover rounded-full mb-2">
    <h3 class="text-lg font-bold">${r.name}</h3>
    <p class="text-gray-500">${r.city}</p>
    <button onclick="window.open('${r.website}','_blank')" 
      class="bg-blue-500 text-white px-3 py-1 mt-2 rounded hover:bg-blue-600">
      ğŸŒ Ø²ÙŠØ§Ø±Ø© Ø§Ù„Ù…ÙˆÙ‚Ø¹
    </button>
    <div class="stars flex gap-1 mt-2"></div>
    <div class="flex gap-2 mt-3">
      <button onclick="toggleFav(${r.id})" class="px-2 py-1 bg-pink-200 rounded text-sm">${r.favorite?"ğŸ’–":"ğŸ¤"}</button>
      <button onclick="editRoaster(${r.id})" class="px-2 py-1 bg-yellow-200 rounded text-sm">âœï¸</button>
      <button onclick="deleteRoaster(${r.id})" class="px-2 py-1 bg-red-200 rounded text-sm">ğŸ—‘ï¸</button>
    </div>
  `;

  // Ø§Ù„Ù†Ø¬ÙˆÙ…
  const starsDiv = card.querySelector(".stars");
  for(let i=1;i<=5;i++){
    const s=document.createElement("span");
    s.textContent=i<=r.rating?"â­":"â˜†";
    s.className="cursor-pointer text-xl";
    s.onclick=()=>{ r.rating=i; saveData(); renderRoasters(); };
    starsDiv.appendChild(s);
  }

  return card;
}

function renderRoasters(){
  const list=document.getElementById("roastersList");
  list.innerHTML="";
  let filtered=[...roasters];

  const q=document.getElementById("search").value.toLowerCase();
  if(q) filtered=filtered.filter(r=>r.name.toLowerCase().includes(q)||r.city.toLowerCase().includes(q));

  if(showFavoritesOnly) filtered=filtered.filter(r=>r.favorite);

  const sort=document.getElementById("sort").value;
  if(sort) filtered=filtered.sort((a,b)=>a[sort].localeCompare(b[sort]));

  const minRating=parseInt(document.getElementById("filterRating").value);
  if(minRating>0) filtered=filtered.filter(r=>r.rating>=minRating);

  filtered.forEach(r=>list.appendChild(renderCard(r)));
}

function addRoaster(e){
  e.preventDefault();
  const id=Date.now();
  const name=document.getElementById("name").value;
  const city=document.getElementById("city").value;
  const website=document.getElementById("website").value;
  const logoInput=document.getElementById("logo");

  let logo="";
  if(logoInput.files[0]){
    const reader=new FileReader();
    reader.onload=function(ev){
      logo=ev.target.result;
      roasters.push({id,name,city,website,logo,rating:0,favorite:false});
      saveData(); renderRoasters();
    };
    reader.readAsDataURL(logoInput.files[0]);
  }else{
    roasters.push({id,name,city,website,logo,rating:0,favorite:false});
    saveData(); renderRoasters();
  }
  e.target.reset();
}

function toggleFav(id){
  const r=roasters.find(x=>x.id===id); if(!r) return;
  r.favorite=!r.favorite; saveData(); renderRoasters();
}

function deleteRoaster(id){
  if(!confirm("Ù‡Ù„ ØªØ±ÙŠØ¯ Ø­Ø°Ù Ù‡Ø°Ù‡ Ø§Ù„Ù…Ø­Ù…ØµØ©ØŸ")) return;
  roasters=roasters.filter(r=>r.id!==id);
  saveData(); renderRoasters();
}

function editRoaster(id){
  const r=roasters.find(x=>x.id===id); if(!r) return;
  document.getElementById("name").value=r.name;
  document.getElementById("city").value=r.city;
  document.getElementById("website").value=r.website;
  deleteRoaster(id);
  window.scrollTo({top:document.body.scrollHeight,behavior:"smooth"});
}

document.getElementById("roasterForm").onsubmit=addRoaster;
document.getElementById("search").oninput=renderRoasters;
document.getElementById("sort").onchange=renderRoasters;
document.getElementById("filterRating").onchange=renderRoasters;
document.getElementById("filterFav").onclick=()=>{showFavoritesOnly=!showFavoritesOnly;renderRoasters();};

renderRoasters();
</script>
</body>
</html>
